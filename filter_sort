 import requests
import json

# Set your CDSW credentials and project details
cdsw_domain = 'your_cdsw_domain'
api_key = 'your_api_key'
source_project_name = 'source_project_name'
source_folder_path = '/path/to/source/folder'
destination_project_name = 'destination_project_name'
destination_folder_path = '/path/to/destination/folder'

# Define CDSW API endpoints
base_url = f"https://{cdsw_domain}/api/v1"
projects_url = f"{base_url}/projects"

# Get source project ID
headers = {
    "Content-Type": "application/json",
    "Authorization": f"Bearer {api_key}"
}
response = requests.get(projects_url, headers=headers)
projects = response.json()
source_project_id = next((p["id"] for p in projects if p["name"] == source_project_name), None)

# Get destination project ID
destination_project_id = next((p["id"] for p in projects if p["name"] == destination_project_name), None)

# List files in source folder
files_url = f"{projects_url}/{source_project_id}/files"
response = requests.get(files_url, headers=headers)
source_files = response.json()

# Copy files to destination project
for file_info in source_files:
    file_path = file_info["path"]
    file_content_url = f"{files_url}/{file_path}"
    response = requests.get(file_content_url, headers=headers)
    file_content = response.content
    
    # Upload files to destination project
    destination_file_path = file_path.replace(source_folder_path, destination_folder_path, 1)
    upload_url = f"{projects_url}/{destination_project_id}/files/{destination_file_path}"
    response = requests.post(upload_url, headers=headers, data=file_content)